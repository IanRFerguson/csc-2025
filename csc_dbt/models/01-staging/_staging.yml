models:
  - name: stg_nba__player_data
    config:
      tags: ["nba"]
    tests:
      - unique:
          column_name: player_id
      - not_null:
          column_name: player_id
      - knicks_players_only:
          config:
            # NOTE - if you change this to "error", the dbt run will fail
            # and all of the downstream models will not run!
            severity: warn

  - name: stg_nba__player_data_incremental
    config:
      tags: ["nba", "incremental"]
    tests:
      - unique:
          column_name: player_id
      - unique:
          column_name: team_initials
      - not_null:
          column_name: player_id

  - name: stg_nba__knicks_players
    tests:
      - knicks_players_only
    config:
      tags: ["nba", "knicks"]